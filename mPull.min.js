!function(t,l){"object"==typeof exports&&"undefined"!=typeof module?module.exports=l():"function"==typeof define&&(define.amd||define.cmd)?define(l):t.mPull=l()}(this,function(){"use strict";var t=function(){function t(t,l,i){var s="touchmove"===l&&{passive:!1,capture:!1};return t.addEventListener(l,i,s)}function l(t,l,i){return t.removeEventListener(l,i,!1)}function i(t){if(void 0!=t)return o.scrollTop=t,void(n.scrollTop=t);var l=o.scrollTop||n.scrollTop;return"CSS1Compat"!=document.compatMode&&(l=n.scrollTop),l}function s(){var t=o.scrollHeight||n.scrollHeight;return"CSS1Compat"!=document.compatMode&&(t=n.scrollHeight),t}function e(){var t=o.clientHeight||n.clientHeight;return"CSS1Compat"!=document.compatMode&&(t=n.clientHeight),t}var o=document.documentElement,n=document.body;return{on:t,off:l,scrollTop:i,scrollHeight:s,clientHeight:e}}(),l=function(t){t=t||{},this.wrapper=document.querySelector(t.el)||document.querySelector("body"),this.usePullDown=t.usePullDown||!1,this.usePullUp=t.usePullUp||!1,this.useAutoLoad=t.useAutoLoad||!1,this.pullDownOffset=t.pullDownOffset||50,this.pullUpOffset=t.pullUpOffset||50,this.autoLoad=t.autoLoad||function(){},this.pullDown=t.pullDown||function(){},this.pullDownMove=t.pullDownMove||function(){},this.pullDownCancel=t.pullDownCancel||function(){},this.pullUp=t.pullUp||function(){},this.pullUpMove=t.pullUpMove||function(){},this.pullUpCancel=t.pullUpCancel||function(){},this._events={},this._init()};return l.prototype={_init:function(){this._initEvent()},_initEvent:function(){t.on(this.wrapper,"touchstart",this._start.bind(this)),t.on(this.wrapper,"touchmove",this._move.bind(this)),t.on(this.wrapper,"touchend",this._end.bind(this)),this.useAutoLoad&&(this.__scroll=this._scroll.bind(this),t.on(window,"scroll",this.__scroll),this.$on("autoLoad",this.autoLoad)),this.$on("pullDown",this.pullDown),this.$on("pullDownMove",this.pullDownMove),this.$on("pullDownCancel",this.pullDownCancel),this.$on("pullUp",this.pullUp),this.$on("pullUpMove",this.pullUpMove),this.$on("pullUpCancel",this.pullUpCancel)},_start:function(l){l.touches&&(this.scrollTop=t.scrollTop(),this.maxHeight=t.scrollHeight()-t.clientHeight(),this.startX=l.touches[0].pageX,this.startY=l.touches[0].pageY,0==this.scrollTop?this.hasPullDown=!0:this.hasPullDown=!1,this.scrollTop==this.maxHeight?this.hasPullUp=!0:this.hasPullUp=!1,this.fixed="",this.deltaX=this.deltaY=0,this.isPullDown=this.isPullUp=!1)},_move:function(t){if(t.touches){if(this.$locked)return t.preventDefault();this.deltaX=t.touches[0].pageX-this.startX,this.deltaY=t.touches[0].pageY-this.startY,this.usePullDown&&this.hasPullDown&&this.deltaY>0&&t.preventDefault(),this.usePullUp&&this.hasPullUp&&this.deltaY<0&&t.preventDefault(),""===this.fixed&&(Math.abs(this.deltaY)>Math.abs(this.deltaX)?this.fixed="top":this.fixed="left"),(this.hasPullDown||this.hasPullUp)&&(this.deltaY/=3),"top"===this.fixed&&this._pullStart(t)}},_end:function(t){t.changedTouches&&"top"===this.fixed&&this._pullEnd()},_pullStart:function(l){return this.usePullDown&&this.hasPullDown&&this.deltaY>0?(t.scrollTop(0),this.isPullDown=this.deltaY>=this.pullDownOffset,this._trigger("pullDownMove",this.deltaY,this.pullDownOffset)):this.usePullUp&&this.hasPullUp&&this.deltaY<0?(t.scrollTop(this.maxHeight-this.deltaY),this.isPullUp=this.deltaY<=-this.pullUpOffset,this._trigger("pullUpMove",Math.abs(this.deltaY),this.pullUpOffset)):void 0},_pullEnd:function(){return this.hasPullDown&&this.deltaY<this.pullDownOffset?this._trigger("pullDownCancel"):this.isPullDown?this._trigger("pullDown",this.pullDownOffset):this.hasPullUp&&this.deltaY>-this.pullUpOffset?this._trigger("pullUpCancel"):this.isPullUp?this._trigger("pullUp",this.pullUpOffset):void 0},_scroll:function(){clearTimeout(this.timer),this.timer=setTimeout(function(){t.scrollTop()==t.scrollHeight()-t.clientHeight()&&this._trigger("autoLoad")}.bind(this),100)},_trigger:function(t){if(this._events[t]){var l=0,i=this._events[t].length;if(i)for(;l<i;l++)this._events[t][l].apply(this,[].slice.call(arguments,1))}},$on:function(t,l){this._events[t]||(this._events[t]=[]),this._events[t].push(l)},$off:function(t,l){if(this._events[t]){if(void 0==l)return this._events[t]=[];var i=this._events[t].indexOf(l);i>-1&&this._events[t].splice(i,1)}},$destroy:function(l){switch(l){case"pullDown":this.$off("pullDownMove"),this.$off("pullDownCancel"),this.$off("pullDown");break;case"pullUp":this.$off("pullUpMove"),this.$off("pullUpCancel"),this.$off("pullUp");break;case"autoLoad":this.$off("scrollEnd"),t.off(window,"scroll",this.__scroll)}},$animate:function(t,l,i,s){s=s||0,t.style.transition="all "+s+"ms",t.style[l]=i}},l});